openapi: 3.0.0
info:
  title: API Veterinaria TechSide
  version: 1.0.0
  description: API para la gestión de la clínica veterinaria TechSide, incluyendo usuarios, mascotas, citas, expedientes, productos y órdenes.
servers:
  - url: http://localhost:3000/api
    description: Servidor de desarrollo local

security:
  - bearerAuth: []

tags:
  - name: Autenticacion
    description: Operaciones de registro e inicio de sesion de usuarios.
  - name: Usuarios
    description: Gestion de perfiles de usuario.
  - name: Mascotas
    description: Gestion de registros de mascotas.
  - name: Citas
    description: Gestion de citas veterinarias.
  - name: Visitas
    description: Gestion de expedientes y visitas clinicas.
  - name: Doctores
    description: Gestion de medicos veterinarios.
  - name: Sucursales
    description: Gestion de sucursales de la clinica.
  - name: Razas
    description: Listado de razas de mascotas.
  - name: MX Divisiones
    description: Datos de divisiones territoriales de Mexico.
  - name: Productos
    description: Gestion de productos de la tienda.
  - name: Ordenes
    description: Gestion de ordenes de la tienda.
  - name: Inventario
    description: Gestion de inventario por producto y sucursal.

paths:
  /auth/registro:
    post:
      summary: Registrar un nuevo usuario
      tags:
        - Autenticacion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/UsuarioRegistro\'
      responses:
        \'201\':
          description: Usuario registrado exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/AuthResponse\'
        \'400\':
          description: Datos de registro invalidos
        \'409\':
          description: El email ya esta registrado

  /auth/login:
    post:
      summary: Iniciar sesion de usuario
      tags:
        - Autenticacion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/UsuarioLogin\'
      responses:
        \'200\':
          description: Inicio de sesion exitoso
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/AuthResponse\'
        \'401\':
          description: Credenciales invalidas

  /usuarios:
    get:
      summary: Obtener lista de usuarios
      tags:
        - Usuarios
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: rol
          schema:
            type: string
            enum: [cliente, medico, recepcionista, admin]
          description: Filtrar usuarios por rol.
      responses:
        \'200\':
          description: Lista de usuarios obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Usuario\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admins/recepcionistas/medicos)

  /usuarios/{id}:
    get:
      summary: Obtener detalles de un usuario
      tags:
        - Usuarios
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID del usuario.
      responses:
        \'200\':
          description: Detalles del usuario obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Usuario\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Usuario no encontrado
    put:
      summary: Actualizar un usuario
      tags:
        - Usuarios
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID del usuario a actualizar.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/UsuarioUpdate\'
      responses:
        \'200\':
          description: Usuario actualizado exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Usuario\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Usuario no encontrado

  /mascotas:
    get:
      summary: Obtener lista de mascotas
      tags:
        - Mascotas
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: propietario_id
          schema:
            type: string
            format: uuid
          description: Filtrar mascotas por ID de propietario.
      responses:
        \'200\':
          description: Lista de mascotas obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Mascota\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
    post:
      summary: Registrar una nueva mascota
      tags:
        - Mascotas
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/MascotaRegistro\'
      responses:
        \'201\':
          description: Mascota registrada exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Mascota\'
        \'400\':
          description: Datos de mascota invalidos
        \'401\':
          description: No autorizado

  /mascotas/{id}:
    get:
      summary: Obtener detalles de una mascota
      tags:
        - Mascotas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la mascota.
      responses:
        \'200\':
          description: Detalles de la mascota obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Mascota\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Mascota no encontrada
    put:
      summary: Actualizar una mascota
      tags:
        - Mascotas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la mascota a actualizar.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/MascotaUpdate\'
      responses:
        \'200\':
          description: Mascota actualizada exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Mascota\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Mascota no encontrada
    delete:
      summary: Eliminar una mascota
      tags:
        - Mascotas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la mascota a eliminar.
      responses:
        \'204\':
          description: Mascota eliminada exitosamente
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Mascota no encontrada

  /citas:
    get:
      summary: Obtener lista de citas
      tags:
        - Citas
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: medico_id
          schema:
            type: string
            format: uuid
          description: Filtrar citas por ID de medico.
        - in: query
          name: fecha
          schema:
            type: string
            format: date
          description: Filtrar citas por fecha (YYYY-MM-DD).
        - in: query
          name: estado
          schema:
            type: string
            enum: [pendiente, confirmada, cancelada, completada]
          description: Filtrar citas por estado.
      responses:
        \'200\':
          description: Lista de citas obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Cita\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
    post:
      summary: Crear una nueva cita
      tags:
        - Citas
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/CitaRegistro\'
      responses:
        \'201\':
          description: Cita creada exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Cita\'
        \'400\':
          description: Datos de cita invalidos
        \'401\':
          description: No autorizado

  /citas/{id}:
    get:
      summary: Obtener detalles de una cita
      tags:
        - Citas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la cita.
      responses:
        \'200\':
          description: Detalles de la cita obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Cita\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Cita no encontrada
    put:
      summary: Actualizar una cita
      tags:
        - Citas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la cita a actualizar.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/CitaUpdate\'
      responses:
        \'200\':
          description: Cita actualizada exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Cita\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Cita no encontrada
    delete:
      summary: Eliminar una cita
      tags:
        - Citas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la cita a eliminar.
      responses:
        \'204\':
          description: Cita eliminada exitosamente
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Cita no encontrada

  /visitas:
    get:
      summary: Obtener lista de visitas
      tags:
        - Visitas
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: mascota_id
          schema:
            type: string
            format: uuid
          description: Filtrar visitas por ID de mascota.
        - in: query
          name: medico_id
          schema:
            type: string
            format: uuid
          description: Filtrar visitas por ID de medico.
      responses:
        \'200\':
          description: Lista de visitas obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Visita\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo medico/recepcionista)
    post:
      summary: Registrar una nueva visita
      tags:
        - Visitas
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/VisitaRegistro\'
      responses:
        \'201\':
          description: Visita registrada exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Visita\'
        \'400\':
          description: Datos de visita invalidos
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo medico)

  /visitas/{id}:
    get:
      summary: Obtener detalles de una visita
      tags:
        - Visitas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la visita.
      responses:
        \'200\':
          description: Detalles de la visita obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Visita\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo medico/recepcionista)
        \'404\':
          description: Visita no encontrada
    put:
      summary: Actualizar una visita
      tags:
        - Visitas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la visita a actualizar.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/VisitaUpdate\'
      responses:
        \'200\':
          description: Visita actualizada exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Visita\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo medico)
        \'404\':
          description: Visita no encontrada
    delete:
      summary: Eliminar una visita
      tags:
        - Visitas
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la visita a eliminar.
      responses:
        \'204\':
          description: Visita eliminada exitosamente
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin/medico)
        \'404\':
          description: Visita no encontrada

  /doctores:
    get:
      summary: Obtener lista de doctores
      tags:
        - Doctores
      responses:
        \'200\':
          description: Lista de doctores obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Doctor\'
    post:
      summary: Registrar un nuevo doctor
      tags:
        - Doctores
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/DoctorRegistro\'
      responses:
        \'201\':
          description: Doctor registrado exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Doctor\'
        \'400\':
          description: Datos de doctor invalidos
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin/recepcionista)

  /doctores/{id}:
    get:
      summary: Obtener detalles de un doctor
      tags:
        - Doctores
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID del doctor.
      responses:
        \'200\':
          description: Detalles del doctor obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Doctor\'
        \'404\':
          description: Doctor no encontrado
    put:
      summary: Actualizar un doctor
      tags:
        - Doctores
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID del doctor a actualizar.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/DoctorUpdate\'
      responses:
        \'200\':
          description: Doctor actualizado exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Doctor\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin/recepcionista)
        \'404\':
          description: Doctor no encontrado
    delete:
      summary: Eliminar un doctor
      tags:
        - Doctores
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID del doctor a eliminar.
      responses:
        \'204\':
          description: Doctor eliminado exitosamente
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin)
        \'404\':
          description: Doctor no encontrado

  /sucursales:
    get:
      summary: Obtener lista de sucursales
      tags:
        - Sucursales
      responses:
        \'200\':
          description: Lista de sucursales obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Sucursal\'

  /sucursales/{id}:
    get:
      summary: Obtener detalles de una sucursal
      tags:
        - Sucursales
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la sucursal.
      responses:
        \'200\':
          description: Detalles de la sucursal obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Sucursal\'
        \'404\':
          description: Sucursal no encontrada

  /razas:
    get:
      summary: Obtener lista de razas
      tags:
        - Razas
      parameters:
        - in: query
          name: especie
          schema:
            type: string
          description: Filtrar razas por especie (ej. perro, gato).
      responses:
        \'200\':
          description: Lista de razas obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Raza\'

  /mx_divisiones:
    get:
      summary: Obtener datos de divisiones de Mexico
      tags:
        - MX Divisiones
      parameters:
        - in: query
          name: estado
          schema:
            type: string
          description: Filtrar por estado.
        - in: query
          name: municipio
          schema:
            type: string
          description: Filtrar por municipio.
        - in: query
          name: colonia
          schema:
            type: string
          description: Filtrar por colonia.
        - in: query
          name: codigo_postal
          schema:
            type: string
          description: Filtrar por codigo postal.
      responses:
        \'200\':
          description: Datos de divisiones obtenidos exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/MXDivision\'

  /productos:
    get:
      summary: Obtener lista de productos
      tags:
        - Productos
      parameters:
        - in: query
          name: categoria
          schema:
            type: string
          description: Filtrar productos por categoria.
      responses:
        \'200\':
          description: Lista de productos obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Producto\'
    post:
      summary: Crear un nuevo producto
      tags:
        - Productos
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/ProductoRegistro\'
      responses:
        \'201\':
          description: Producto creado exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Producto\'
        \'400\':
          description: Datos de producto invalidos
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin/recepcionista)

  /productos/{id}:
    get:
      summary: Obtener detalles de un producto
      tags:
        - Productos
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID del producto.
      responses:
        \'200\':
          description: Detalles del producto obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Producto\'
        \'404\':
          description: Producto no encontrado
    put:
      summary: Actualizar un producto
      tags:
        - Productos
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID del producto a actualizar.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/ProductoUpdate\'
      responses:
        \'200\':
          description: Producto actualizado exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Producto\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin/recepcionista)
        \'404\':
          description: Producto no encontrado
    delete:
      summary: Eliminar un producto
      tags:
        - Productos
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID del producto a eliminar.
      responses:
        \'204\':
          description: Producto eliminado exitosamente
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin/recepcionista)
        \'404\':
          description: Producto no encontrado

  /ordenes:
    get:
      summary: Obtener lista de ordenes
      tags:
        - Ordenes
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: usuario_id
          schema:
            type: string
            format: uuid
          description: Filtrar ordenes por ID de usuario.
        - in: query
          name: estado
          schema:
            type: string
            enum: [pendiente, procesando, enviado, entregado, cancelado]
          description: Filtrar ordenes por estado.
      responses:
        \'200\':
          description: Lista de ordenes obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Orden\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
    post:
      summary: Crear una nueva orden
      tags:
        - Ordenes
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/OrdenRegistro\'
      responses:
        \'201\':
          description: Orden creada exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Orden\'
        \'400\':
          description: Datos de orden invalidos
        \'401\':
          description: No autorizado

  /ordenes/{id}:
    get:
      summary: Obtener detalles de una orden
      tags:
        - Ordenes
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la orden.
      responses:
        \'200\':
          description: Detalles de la orden obtenidos exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Orden\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Orden no encontrada
    put:
      summary: Actualizar una orden
      tags:
        - Ordenes
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la orden a actualizar.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/OrdenUpdate\'
      responses:
        \'200\':
          description: Orden actualizada exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Orden\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Orden no encontrada
    delete:
      summary: Eliminar una orden
      tags:
        - Ordenes
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la orden a eliminar.
      responses:
        \'204\':
          description: Orden eliminada exitosamente
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado
        \'404\':
          description: Orden no encontrada

  /inventario:
    get:
      summary: Obtener estado del inventario
      tags:
        - Inventario
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: sucursal_id
          schema:
            type: string
            format: uuid
          description: Filtrar inventario por ID de sucursal.
        - in: query
          name: producto_id
          schema:
            type: string
            format: uuid
          description: Filtrar inventario por ID de producto.
      responses:
        \'200\':
          description: Estado del inventario obtenido exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: \'#/components/schemas/Inventario\'
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin/recepcionista)
    post:
      summary: Crear o actualizar un registro de inventario
      tags:
        - Inventario
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: \'#/components/schemas/InventarioRegistro\'
      responses:
        \'201\':
          description: Registro de inventario creado/actualizado exitosamente
          content:
            application/json:
              schema:
                $ref: \'#/components/schemas/Inventario\'
        \'400\':
          description: Datos de inventario invalidos
        \'401\':
          description: No autorizado
        \'403\':
          description: Acceso denegado (solo admin/recepcionista)

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    UsuarioRegistro:
      type: object
      required:
        - email
        - password
        - rol
        - nombre_completo
      properties:
        email:
          type: string
          format: email
          description: Correo electronico del usuario.
        password:
          type: string
          format: password
          description: Contraseña del usuario.
          minLength: 6
        rol:
          type: string
          enum: [cliente, medico, recepcionista, admin]
          description: Rol del usuario.
        nombre_completo:
          type: string
          description: Nombre completo del usuario.
        telefono:
          type: string
          nullable: true
          description: Numero de telefono.
        direccion:
          type: object
          nullable: true
          properties:
            calle: {type: string}
            codigo_postal: {type: string}
            colonia: {type: string}
            municipio: {type: string}
            estado: {type: string}
        avatar_url:
          type: string
          nullable: true
          format: uri
          description: URL del avatar del usuario.

    UsuarioLogin:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password

    AuthResponse:
      type: object
      properties:
        token:
          type: string
          description: Token de autenticacion JWT.
        usuario:
          $ref: \'#/components/schemas/Usuario\'

    Usuario:
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          format: email
        rol:
          type: string
          enum: [cliente, medico, recepcionista, admin]
        nombre_completo:
          type: string
        telefono:
          type: string
          nullable: true
        direccion:
          type: object
          nullable: true
          properties:
            calle: {type: string}
            codigo_postal: {type: string}
            colonia: {type: string}
            municipio: {type: string}
            estado: {type: string}
        avatar_url:
          type: string
          nullable: true
          format: uri
        creado_en:
          type: string
          format: date-time
        actualizado_en:
          type: string
          format: date-time

    UsuarioUpdate:
      type: object
      properties:
        email:
          type: string
          format: email
        password:
          type: string
          format: password
          minLength: 6
        nombre_completo:
          type: string
        telefono:
          type: string
          nullable: true
        direccion:
          type: object
          nullable: true
          properties:
            calle: {type: string}
            codigo_postal: {type: string}
            colonia: {type: string}
            municipio: {type: string}
            estado: {type: string}
        avatar_url:
          type: string
          nullable: true
          format: uri

    MascotaRegistro:
      type: object
      required:
        - nombre
        - tipo
        - propietario_id
      properties:
        propietario_id:
          type: string
          format: uuid
          description: ID del usuario propietario de la mascota.
        ruac:
          type: string
          nullable: true
          description: Codigo RUAC de la mascota.
        nombre:
          type: string
        tipo:
          type: string
          description: Especie de la mascota (ej. perro, gato, ave).
        raza:
          type: string
          nullable: true
        fecha_nacimiento:
          type: string
          format: date
          nullable: true
        sexo:
          type: string
          nullable: true
        peso:
          type: number
          format: float
          nullable: true
        esterilizado:
          type: boolean
          default: false
        microchip:
          type: string
          nullable: true
        comportamiento:
          type: string
          nullable: true
        condiciones_cronicas:
          type: string
          nullable: true
        alergias:
          type: string
          nullable: true
        medicamentos:
          type: string
          nullable: true
        imagen_url:
          type: string
          format: uri
          nullable: true

    MascotaUpdate:
      type: object
      properties:
        propietario_id:
          type: string
          format: uuid
        ruac:
          type: string
          nullable: true
        nombre:
          type: string
        tipo:
          type: string
        raza:
          type: string
          nullable: true
        fecha_nacimiento:
          type: string
          format: date
          nullable: true
        sexo:
          type: string
          nullable: true
        peso:
          type: number
          format: float
          nullable: true
        esterilizado:
          type: boolean
        microchip:
          type: string
          nullable: true
        comportamiento:
          type: string
          nullable: true
        condiciones_cronicas:
          type: string
          nullable: true
        alergias:
          type: string
          nullable: true
        medicamentos:
          type: string
          nullable: true
        imagen_url:
          type: string
          format: uri
          nullable: true

    Mascota:
      allOf:
        - $ref: \'#/components/schemas/MascotaRegistro\'
        - type: object
          properties:
            id:
              type: string
              format: uuid
            creado_en:
              type: string
              format: date-time
            actualizado_en:
              type: string
              format: date-time

    CitaRegistro:
      type: object
      required:
        - medico_id
        - fecha
        - hora_inicio
      properties:
        mascota_id:
          type: string
          format: uuid
          nullable: true
        propietario_id:
          type: string
          format: uuid
          nullable: true
        medico_id:
          type: string
          format: uuid
        sucursal_id:
          type: string
          format: uuid
          nullable: true
        fecha:
          type: string
          format: date
        hora_inicio:
          type: string
          format: time
        hora_fin:
          type: string
          format: time
          nullable: true
        estado:
          type: string
          enum: [pendiente, confirmada, cancelada, completada]
          default: pendiente
        procedimiento:
          type: string
          nullable: true
        creado_por:
          type: string
          format: uuid
          nullable: true

    CitaUpdate:
      type: object
      properties:
        mascota_id:
          type: string
          format: uuid
          nullable: true
        propietario_id:
          type: string
          format: uuid
          nullable: true
        medico_id:
          type: string
          format: uuid
        sucursal_id:
          type: string
          format: uuid
          nullable: true
        fecha:
          type: string
          format: date
        hora_inicio:
          type: string
          format: time
        hora_fin:
          type: string
          format: time
          nullable: true
        estado:
          type: string
          enum: [pendiente, confirmada, cancelada, completada]
        procedimiento:
          type: string
          nullable: true
        creado_por:
          type: string
          format: uuid
          nullable: true

    Cita:
      allOf:
        - $ref: \'#/components/schemas/CitaRegistro\'
        - type: object
          properties:
            id:
              type: string
              format: uuid
            creado_en:
              type: string
              format: date-time
            actualizado_en:
              type: string
              format: date-time

    VisitaRegistro:
      type: object
      required:
        - mascota_id
        - medico_id
        - atendido_en
      properties:
        mascota_id:
          type: string
          format: uuid
        medico_id:
          type: string
          format: uuid
        propietario_id:
          type: string
          format: uuid
          nullable: true
        atendido_en:
          type: string
          format: date-time
        notas:
          type: string
          nullable: true
        diagnostico:
          type: string
          nullable: true
        tratamientos:
          type: string
          nullable: true
        recetas:
          type: array
          items: {type: string} # O un schema mas detallado para cada receta
          nullable: true
        archivos:
          type: array
          items: {type: string, format: uri} # URLs de archivos
          nullable: true

    VisitaUpdate:
      type: object
      properties:
        mascota_id:
          type: string
          format: uuid
        medico_id:
          type: string
          format: uuid
        propietario_id:
          type: string
          format: uuid
          nullable: true
        atendido_en:
          type: string
          format: date-time
        notas:
          type: string
          nullable: true
        diagnostico:
          type: string
          nullable: true
        tratamientos:
          type: string
          nullable: true
        recetas:
          type: array
          items: {type: string}
          nullable: true
        archivos:
          type: array
          items: {type: string, format: uri}
          nullable: true

    Visita:
      allOf:
        - $ref: \'#/components/schemas/VisitaRegistro\'
        - type: object
          properties:
            id:
              type: string
              format: uuid
            creado_en:
              type: string
              format: date-time

    DoctorRegistro:
      type: object
      required:
        - nombre
        - sucursal_id
      properties:
        usuario_id:
          type: string
          format: uuid
          nullable: true
        nombre:
          type: string
        sucursal_id:
          type: string
          format: uuid
        especialidades:
          type: array
          items: {type: string}
          nullable: true
        horario_disponible:
          type: object
          nullable: true
          description: Horario disponible en formato JSON (ej. {lunes: [{inicio: \'09:00\', fin: \'17:00\'}]})

    DoctorUpdate:
      type: object
      properties:
        usuario_id:
          type: string
          format: uuid
          nullable: true
        nombre:
          type: string
        sucursal_id:
          type: string
          format: uuid
        especialidades:
          type: array
          items: {type: string}
          nullable: true
        horario_disponible:
          type: object
          nullable: true

    Doctor:
      allOf:
        - $ref: \'#/components/schemas/DoctorRegistro\'
        - type: object
          properties:
            id:
              type: string
              format: uuid
            creado_en:
              type: string
              format: date-time

    Sucursal:
      type: object
      properties:
        id:
          type: string
          format: uuid
        nombre:
          type: string
        direccion:
          type: object
          properties:
            calle: {type: string}
            codigo_postal: {type: string}
            colonia: {type: string}
            municipio: {type: string}
            estado: {type: string}
        telefono:
          type: string
        zona_horaria:
          type: string
        meta:
          type: object
          nullable: true
        creado_en:
          type: string
          format: date-time

    Raza:
      type: object
      properties:
        id:
          type: string
          format: uuid
        especie:
          type: string
        nombre:
          type: string

    MXDivision:
      type: object
      properties:
        id:
          type: string
          format: uuid
        estado:
          type: string
        municipio:
          type: string
        colonia:
          type: string
        codigo_postal:
          type: string
          nullable: true
        meta:
          type: object
          nullable: true

    ProductoRegistro:
      type: object
      required:
        - nombre
        - precio
        - categoria
      properties:
        sku:
          type: string
          nullable: true
        nombre:
          type: string
        descripcion:
          type: string
          nullable: true
        precio:
          type: number
          format: float
        stock:
          type: integer
          default: 0
        categoria:
          type: string
        imagenes:
          type: array
          items: {type: string, format: uri}
          nullable: true
        meta:
          type: object
          nullable: true

    ProductoUpdate:
      type: object
      properties:
        sku:
          type: string
          nullable: true
        nombre:
          type: string
        descripcion:
          type: string
          nullable: true
        precio:
          type: number
          format: float
        stock:
          type: integer
        categoria:
          type: string
        imagenes:
          type: array
          items: {type: string, format: uri}
          nullable: true
        meta:
          type: object
          nullable: true

    Producto:
      allOf:
        - $ref: \'#/components/schemas/ProductoRegistro\'
        - type: object
          properties:
            id:
              type: string
              format: uuid
            creado_en:
              type: string
              format: date-time
            actualizado_en:
              type: string
              format: date-time

    OrdenRegistro:
      type: object
      required:
        - usuario_id
        - items
        - total
        - sucursal_id
      properties:
        usuario_id:
          type: string
          format: uuid
        items:
          type: array
          items:
            type: object
            required: [producto_id, cantidad, precio_unitario]
            properties:
              producto_id: {type: string, format: uuid}
              cantidad: {type: integer, minimum: 1}
              precio_unitario: {type: number, format: float}
        total:
          type: number
          format: float
        sucursal_id:
          type: string
          format: uuid
        estado:
          type: string
          enum: [pendiente, procesando, enviado, entregado, cancelado]
          default: pendiente

    OrdenUpdate:
      type: object
      properties:
        items:
          type: array
          items:
            type: object
            required: [producto_id, cantidad, precio_unitario]
            properties:
              producto_id: {type: string, format: uuid}
              cantidad: {type: integer, minimum: 1}
              precio_unitario: {type: number, format: float}
        total:
          type: number
          format: float
        sucursal_id:
          type: string
          format: uuid
        estado:
          type: string
          enum: [pendiente, procesando, enviado, entregado, cancelado]

    Orden:
      allOf:
        - $ref: \'#/components/schemas/OrdenRegistro\'
        - type: object
          properties:
            id:
              type: string
              format: uuid
            creado_en:
              type: string
              format: date-time
            actualizado_en:
              type: string
              format: date-time

    InventarioRegistro:
      type: object
      required:
        - producto_id
        - sucursal_id
        - cantidad
      properties:
        producto_id:
          type: string
          format: uuid
        sucursal_id:
          type: string
          format: uuid
        cantidad:
          type: integer
          minimum: 0

    Inventario:
      allOf:
        - $ref: \'#/components/schemas/InventarioRegistro\'
        - type: object
          properties:
            id:
              type: string
              format: uuid
            actualizado_en:
              type: string
              format: date-time
```, filePath = "backend/openapi.yaml"))