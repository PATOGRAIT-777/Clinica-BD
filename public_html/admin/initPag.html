<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AnimeAV1 ‚Äî Inicio</title>
  <link rel="stylesheet" href="../css/universalCss.css" type="text/css">
  <link rel="stylesheet" href="../css/divs.css" type="text/css">
  <link rel="stylesheet" href="../css/pInicio.css" type="text/css">
</head>

    <div id="login-modal" class="login-modal" onclick="closeOnOutsideClick(event)">
      <div class="login-content">
        <span class="close" onclick="closeLogin()">&times;</span>
        <img src="https://cdn.animeav1.com/backdrops/2067.jpg" alt="Banner Login" class="login-banner">
        
        <form class="login-form" id="loginForm">
          <h2>Iniciar Sesi√≥n</h2>
          <input type="email" id="loginEmail" placeholder="Usuario (Email)" required>
          <input type="password" id="loginPassword" placeholder="Contrase√±a" required>
          
          <button type="submit" id="btnLogin">Entrar</button>
          
          <p id="loginError" style="color: red; display: none; text-align: center; margin-top: 10px;"></p>
        </form>
      </div>
    </div>

    <script> 
        function openLogin() {
          document.getElementById('login-modal').style.display = 'flex';
        }

        function closeLogin() {
          document.getElementById('login-modal').style.display = 'none';
        }

function closeOnOutsideClick(event) {
  const modal = document.getElementById('login-modal');
  const box = modal.querySelector('.login-content');

  if (box && !box.contains(event.target)) {
    closeLogin();
  }
}

    </script>
    
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a class="brand" href="initPag.html">üê∂ TechSide Vet</a>
      <nav class="main-nav" aria-label="Navegaci√≥n principal">
        <a class="active" href="initPag.html">Inicio</a>
        <a href="prodCatalog.html">Tienda</a>
        <a href="horario.html">Disponibilidad</a>
        <a href="listas.html">Mis mascotas</a>
        <a href="regUser.html">Mi cuenta</a>
      </nav>
      <div class="header-actions">
        <button class="btn-ghost" ><a href="formAgregar.html">Registrarse</a></button>
        <button class="btn-primary" onclick="openLogin()">Entrar</button>
      </div>
    </div>
  </header>

        <section class="services">
            <div class="container">
                <div class="section-title">
                    <h2>Nuestros Servicios</h2>
                    <p>Ofrecemos atenci√≥n m√©dica integral para todas las especies con equipos de √∫ltima generaci√≥n</p>
                </div>
                <div class="grid grid-4">
                    <div class="card">
                        <div class="card-icon">‚ù§Ô∏è</div>
                        <h3>Consultas Generales</h3>
                        <p>Revisiones completas para mantener la salud de tu mascota</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üõ°Ô∏è</div>
                        <h3>Vacunaci√≥n</h3>
                        <p>Programas de vacunaci√≥n personalizados y seguros</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">‚è∞</div>
                        <h3>Urgencias 24/7</h3>
                        <p>Atenci√≥n de emergencia disponible las 24 horas</p>
                    </div>
                    <div class="card">
                        <div class="card-icon">üèÜ</div>
                        <h3>Cirug√≠as</h3>
                        <p>Procedimientos quir√∫rgicos con tecnolog√≠a avanzada</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="promotions">
            <div class="container">
                <div class="section-title">
                    <h2>Promociones Especiales</h2>
                    <p>Aprovecha nuestras ofertas exclusivas para el cuidado de tu mascota</p>
                </div>
                <div class="grid grid-3">
                    <div class="card">
                        <div class="badge">20% OFF</div>
                        <h3>Consulta + Vacunaci√≥n</h3>
                        <p>Paquete completo de revisi√≥n y vacunas</p>
                        <div class="price">$120 <span class="original-price">$150</span></div>
                        <button>Reservar Ahora</button>
                    </div>
                    <div class="card">
                        <div class="badge">15% OFF</div>
                        <h3>Ba√±o y Corte Premium</h3>
                        <p>Servicio completo de est√©tica canina</p>
                        <div class="price">$68 <span class="original-price">$80</span></div>
                        <button>Reservar Ahora</button>
                    </div>
                    <div class="card">
                        <div class="badge">25% OFF</div>
                        <h3>Desparasitaci√≥n Completa</h3>
                        <p>Tratamiento interno y externo</p>
                        <div class="price">$75 <span class="original-price">$100</span></div>
                        <button>Reservar Ahora</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="testimonials">
            <div class="container">
                <div class="section-title">
                    <h2>Lo que dicen nuestros clientes</h2>
                    <p>La satisfacci√≥n de nuestros clientes y sus mascotas es nuestra mayor recompensa</p>
                </div>
                <div class="grid grid-3">
                    <div class="card testimonial">
                        <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                        <h3>Mar√≠a Gonz√°lez</h3>
                        <p>Due√±o de Golden Retriever</p>
                        <p>"Excelente atenci√≥n, mi perro Max se siente como en casa aqu√≠."</p>
                    </div>
                    <div class="card testimonial">
                        <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                        <h3>Carlos Rodr√≠guez</h3>
                        <p>Due√±o de Gato Persa</p>
                        <p>"Profesionales incre√≠bles, salvaron la vida de mi gata Luna."</p>
                    </div>
                    <div class="card testimonial">
                        <div class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                        <h3>Ana Mart√≠nez</h3>
                        <p>Due√±o de Labrador</p>
                        <p>"La mejor cl√≠nica veterinaria de la ciudad, sin duda."</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="cta">
            <div class="container">
                <h2>¬øListo para cuidar a tu mascota?</h2>
                <p>Agenda una cita hoy mismo y descubre por qu√© somos la cl√≠nica veterinaria de confianza para miles de familias</p>
                <div class="cta-buttons">
                    <button>Agendar Cita Ahora</button>
                    <button class="whatsapp">Contactar por WhatsApp</button>
                </div>
            </div>
        </section>

  <footer class="site-footer">
    <div class="container footer-inner">
      <p>¬© <span id="year"></span> TechSide</p>
      <small class="muted">T√©rminos y condiciones ¬∑ Pol√≠tica de privacidad</small>
    </div>
  </footer>

  <script> 
  document.getElementById('year').textContent = new Date().getFullYear(); 
    // Fecha del footer (esto ya lo ten√≠as)
    const yearSpan = document.getElementById('year');
    if(yearSpan) yearSpan.textContent = new Date().getFullYear();

    // --- FUNCIONES VISUALES DEL MODAL ---
    function openLogin() {
      document.getElementById('login-modal').style.display = 'flex';
      document.getElementById('loginError').style.display = 'none'; // Limpia errores previos
    }

    function closeLogin() {
      document.getElementById('login-modal').style.display = 'none';
    }

    function closeOnOutsideClick(event) {
      if (event.target.id === 'login-modal') {
        closeLogin();
      }
    }

    // --- L√ìGICA DE CONEXI√ìN (NUEVO) ---
    const loginForm = document.getElementById('loginForm');
    
    if (loginForm) {
        loginForm.addEventListener('submit', async function(e) {
            e.preventDefault(); // 1. Evita que la p√°gina se recargue

            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorMsg = document.getElementById('loginError');
            const btn = document.getElementById('btnLogin');
            const originalText = btn.textContent;

            // 2. Estado de carga visual
            btn.textContent = "Verificando...";
            btn.disabled = true;
            errorMsg.style.display = 'none';

            try {
                // 3. Petici√≥n al Backend
                const response = await fetch('http://localhost:3000/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: email, password: password })
                });

                const data = await response.json();

                if (response.ok) {
                    // 4. Si es correcto: Guardar sesi√≥n
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('usuario', JSON.stringify(data.usuario));

                    // 5. Redireccionar seg√∫n el rol (Admin o Cliente)
                    if (data.usuario.rol === 'cliente') {
                        window.location.href = 'regUser.html';
                    } else {
                        window.location.href = 'regUserAdmin.html'; 
                    }
                } else {
                    // Error: Contrase√±a mal o usuario no existe
                    errorMsg.textContent = data.mensaje || "Datos incorrectos";
                    errorMsg.style.display = 'block';
                    btn.textContent = originalText;
                    btn.disabled = false;
                }
            } catch (error) {
                console.error("Error:", error);
                errorMsg.textContent = "No se pudo conectar con el servidor";
                errorMsg.style.display = 'block';
                btn.textContent = originalText;
                btn.disabled = false;
            }
        });
    }
  </script>
</body>
</html>
